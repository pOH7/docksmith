name: Sync OpenVSCode Server

on:
  schedule:
    - cron: '0 18,0,6,12 * * *'  # Every 6 hours (2AM, 8AM, 2PM, 8PM UTC+8)
  workflow_dispatch:

jobs:
  sync:
    uses: ./.github/workflows/sync-multi-template.yml
    with:
      config: |
        {
          "version_key": "linuxserver/docker-openvscode-server",
          "source_repo": "linuxserver/docker-openvscode-server",
          "sync_type": "release",
          "components": [
            {
              "type": "dockerfile",
              "image_name": "openvscode-server",
              "dockerfile": "FROM lscr.io/linuxserver/openvscode-server:{VERSION}\nRUN apt-get update && \\\n    apt-get install -y \\\n    vim \\\n    python3 python3-venv python3-pip && \\\n    python3 -m venv .venv && \\\n    .venv/bin/pip install jupyter pandas openpyxl xlrd pyxlsb xlsxwriter && \\\n    apt-get clean && \\\n    rm -rf \\\n      /tmp/* \\\n      /var/lib/apt/lists/* \\\n      /var/tmp/* && \\\n    /app/openvscode-server/bin/openvscode-server --install-extension ms-toolsai.jupyter ms-python.python"
            }
          ]
        }
    secrets: inherit
